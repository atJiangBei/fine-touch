!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).FineTouch={})}(this,(function(e){"use strict";const t=e=>e instanceof TouchEvent;class o{constructor(e){const{root:o,moveCallback:n=(()=>{}),startCallback:s=(()=>{}),endCallback:i=(()=>{})}=e;this.hasMove=!0,this.isStart=!1,this.root=o;const c=[];let d=0,h=0,r=0,u=0,a=0;var m;this.startMethod=e=>{this.hasMove=!1,this.isStart=!0,"mousedown"===e.type&&e.preventDefault();const o=t(e)?e.touches[0]:e,{clientX:n,clientY:i}=o;u=n,a=i,h=n,r=i,d=e.timeStamp,s({startX:n,startY:i,event:e})},this.moveMethod=e=>{if(this.hasMove=!0,!this.isStart)return;const o=t(e)?e.touches[0]:e,{clientX:s,clientY:i}=o;n({movedX:s-u,movedY:i-a,stepX:s-h,stepY:i-r,event:e}),h=s,r=i,c.length>20&&c.splice(0,10),c.push(e),d=e.timeStamp},this.endMethod=e=>{if(!this.isStart)return;if(this.isStart=!1,!this.hasMove)return void(this.hasMove=!0);let o=0,n=0;if(e.timeStamp-d<=100){const e=c.length-1;let s=e;for(let t=e;t>=0;t--){c[t].timeStamp+100>d&&(s=t)}if(s!==e){const i=c[e].timeStamp-c[s].timeStamp,d=c[s],u=t(d)?d.touches[0]:d,{clientX:a,clientY:m}=u;o=(h-a)/i*(1e3/60),n=(r-m)/i*(1e3/60)}}const s=t(e)?e.changedTouches[0]:e,{clientX:m,clientY:v}=s;i({movedX:m-u,movedY:v-a,speedX:o,speedY:n,event:e}),h=0,r=0,u=0,a=0,d=0,c.length=0},function(e,t){e.addEventListener("touchstart",t),e.addEventListener("mousedown",t)}(o,this.startMethod),m=this.moveMethod,document.addEventListener("touchmove",m),document.addEventListener("mousemove",m),function(e,t){document.addEventListener("touchend",t),document.addEventListener("touchcancel",t),document.addEventListener("mouseup",t)}(0,this.endMethod)}destroy(){var e,t;e=this.root,t=this.startMethod,e.removeEventListener("touchstart",t),e.removeEventListener("mousedown",t),function(e,t){document.removeEventListener("touchmove",t),document.removeEventListener("mousemove",t)}(this.root,this.moveMethod),function(e,t){document.removeEventListener("touchend",t),document.removeEventListener("touchcancel",t),document.removeEventListener("mouseup",t)}(this.root,this.endMethod)}}e.FineTouch=o,e.createTouch=e=>new o(e),Object.defineProperty(e,"__esModule",{value:!0})}));
